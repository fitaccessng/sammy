{% extends "admin/base_simple.html" %}

{% block title %}Payroll Approvals - Admin{% endblock %}

{% block header %}Payroll Approvals{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="flex justify-between items-center mb-6">
    <div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Payroll Approvals</h2>
        <p class="text-gray-600">Review and approve payroll submissions from HR</p>
    </div>
    <a href="{{ url_for('dashboard.hq_hr_dashboard') }}" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors duration-200">
        <i class='bx bx-arrow-back mr-2'></i>Back to HR Dashboard
    </a>
</div>

<!-- Pending Approvals -->
{% if approvals %}
<div class="card bg-white rounded-lg shadow-md">
    <div class="p-6 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-800">Pending Payroll Submissions</h3>
        <p class="text-gray-600 text-sm mt-1">{{ approvals|length }} payroll(s) awaiting your approval</p>
    </div>
    
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Period</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Submitted By</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Submitted Date</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Employees</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Amount</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for approval in approvals %}
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">{{ approval.period }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">{{ approval.submitted_by }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">
                            {{ approval.submitted_at.strftime('%d/%m/%Y %H:%M') }}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">{{ approval.employee_count }} employees</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">â‚¦{{ "{:,.2f}".format(approval.total_amount) }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full 
                                   {% if approval.status == 'pending_admin' %}bg-yellow-100 text-yellow-800
                                   {% elif approval.status == 'approved' %}bg-green-100 text-green-800
                                   {% elif approval.status == 'rejected' %}bg-red-100 text-red-800
                                   {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {{ approval.status.replace('_', ' ').title() }}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex space-x-2">
                            <a href="{{ url_for('view_payroll_details', approval_id=approval.id) }}" 
                               class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition-colors duration-200">
                                <i class='bx bx-show mr-1'></i>Review
                            </a>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="card bg-white p-8 text-center">
    <i class='bx bxs-wallet text-6xl text-gray-300 mb-4'></i>
    <h3 class="text-lg font-semibold text-gray-800 mb-2">No Pending Approvals</h3>
    <p class="text-gray-600 mb-4">There are currently no payroll submissions awaiting approval.</p>
    <a href="{{ url_for('dashboard.hq_hr_dashboard') }}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200">
        <i class='bx bx-dashboard mr-2'></i>Back to HR Dashboard
    </a>
</div>
{% endif %}

<!-- Recent Actions (if any approved/rejected items exist) -->
<div class="mt-6">
    <div class="card bg-white p-6">
        <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Actions</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <a href="{{ url_for('dashboard.hq_hr_dashboard') }}" 
               class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-md transition-all duration-200">
                <div class="bg-blue-100 p-2 rounded-lg mr-3">
                    <i class='bx bxs-dashboard text-blue-600'></i>
                </div>
                <div>
                    <div class="font-medium text-gray-800">HR Dashboard</div>
                    <div class="text-sm text-gray-600">Overview & analytics</div>
                </div>
            </a>
            
            <a href="{{ url_for('admin.view_employees') }}" 
               class="flex items-center p-4 border border-gray-200 rounded-lg hover:border-green-300 hover:shadow-md transition-all duration-200">
                <div class="bg-green-100 p-2 rounded-lg mr-3">
                    <i class='bx bxs-group text-green-600'></i>
                </div>
                <div>
                    <div class="font-medium text-gray-800">All Employees</div>
                    <div class="text-sm text-gray-600">View employee list</div>
                </div>
            </a>
            
            
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.card {
    border-radius: 0.5rem;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
}

.table-hover tbody tr:hover {
    background-color: rgba(249, 250, 251, 1);
}

.btn-action {
    transition: all 0.2s ease;
}

.btn-action:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
</style>
{% endblock %}