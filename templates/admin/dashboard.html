{% extends "admin/base_simple.html" %}

{% block title %}Admin Dashboard - Construction Management System{% endblock %}

{% block header %}Admin Dashboard{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="mb-6">
    <h2 class="text-2xl font-bold text-gray-800 mb-2">Administration Dashboard</h2>
    <p class="text-gray-600">Manage roles, permissions, and organizational structure</p>
</div>

<!-- Key Metrics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
    <!-- Total Roles Card -->
    <div class="card bg-white p-6 metric-card border-l-blue-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500 text-sm font-medium uppercase tracking-wide">Total Roles</p>
                <h3 class="text-3xl font-bold text-gray-800 mt-2">{{ summary.total_roles or 0 }}</h3>
                <p class="text-green-500 text-sm mt-2">
                    <i class='bx bx-up-arrow-alt'></i>
                    Active roles in system
                </p>
            </div>
            <div class="bg-blue-100 p-3 rounded-full">
                <i class='bx bxs-user-detail text-2xl text-blue-600'></i>
            </div>
        </div>
    </div>

    <!-- Reporting Lines Card -->
    <div class="card bg-white p-6 metric-card border-l-green-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500 text-sm font-medium uppercase tracking-wide">Reporting Lines</p>
                <h3 class="text-3xl font-bold text-gray-800 mt-2">{{ summary.total_reporting_lines or 0 }}</h3>
                <p class="text-green-500 text-sm mt-2">
                    <i class='bx bx-network-chart'></i>
                    Organizational structure
                </p>
            </div>
            <div class="bg-green-100 p-3 rounded-full">
                <i class='bx bxs-network-chart text-2xl text-green-600'></i>
            </div>
        </div>
    </div>

    <!-- Approval Hierarchies Card -->
    <div class="card bg-white p-6 metric-card border-l-yellow-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500 text-sm font-medium uppercase tracking-wide">Approval Levels</p>
                <h3 class="text-3xl font-bold text-gray-800 mt-2">{{ summary.total_approval_hierarchies or 0 }}</h3>
                <p class="text-yellow-500 text-sm mt-2">
                    <i class='bx bx-check-circle'></i>
                    Workflow processes
                </p>
            </div>
            <div class="bg-yellow-100 p-3 rounded-full">
                <i class='bx bxs-layer text-2xl text-yellow-600'></i>
            </div>
        </div>
    </div>

    <!-- Total Permissions Card -->
    <div class="card bg-white p-6 metric-card border-l-red-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-gray-500 text-sm font-medium uppercase tracking-wide">Permissions</p>
                <h3 class="text-3xl font-bold text-gray-800 mt-2">{{ summary.total_permissions or 0 }}</h3>
                <p class="text-red-500 text-sm mt-2">
                    <i class='bx bx-shield-alt'></i>
                    Access controls
                </p>
            </div>
            <div class="bg-red-100 p-3 rounded-full">
                <i class='bx bxs-key text-2xl text-red-600'></i>
            </div>
        </div>
    </div>
</div>

<!-- Management Sections -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Quick Actions -->
    <div class="lg:col-span-2">
        <div class="card bg-white p-6">
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Administrative Actions</h3>
                <p class="text-gray-600 text-sm">Quick access to key management functions</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <a href="{{ url_for('admin.roles_view') }}" class="block p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-md transition-all duration-200">
                    <div class="flex items-center">
                        <div class="bg-blue-100 p-3 rounded-lg mr-4">
                            <i class='bx bxs-user-detail text-blue-600 text-xl'></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Manage Roles</h4>
                            <p class="text-gray-600 text-sm">Define system roles</p>
                        </div>
                    </div>
                </a>

                <a href="{{ url_for('admin.reporting_lines_view') }}" class="block p-4 border border-gray-200 rounded-lg hover:border-green-300 hover:shadow-md transition-all duration-200">
                    <div class="flex items-center">
                        <div class="bg-green-100 p-3 rounded-lg mr-4">
                            <i class='bx bxs-network-chart text-green-600 text-xl'></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Reporting Lines</h4>
                            <p class="text-gray-600 text-sm">Organizational structure</p>
                        </div>
                    </div>
                </a>

                <a href="{{ url_for('admin.approval_hierarchy_view') }}" class="block p-4 border border-gray-200 rounded-lg hover:border-yellow-300 hover:shadow-md transition-all duration-200">
                    <div class="flex items-center">
                        <div class="bg-yellow-100 p-3 rounded-lg mr-4">
                            <i class='bx bxs-layer text-yellow-600 text-xl'></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Approval Hierarchy</h4>
                            <p class="text-gray-600 text-sm">Workflow setup</p>
                        </div>
                    </div>
                </a>

                <a href="{{ url_for('admin.permissions_view') }}" class="block p-4 border border-gray-200 rounded-lg hover:border-red-300 hover:shadow-md transition-all duration-200">
                    <div class="flex items-center">
                        <div class="bg-red-100 p-3 rounded-lg mr-4">
                            <i class='bx bxs-key text-red-600 text-xl'></i>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800">Permissions</h4>
                            <p class="text-gray-600 text-sm">Access control</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="space-y-6">
        <!-- System Overview -->
        <div class="card bg-white p-6">
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">System Overview</h3>
                <p class="text-gray-600 text-sm">Current system status</p>
            </div>
            
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">Database</span>
                    <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Online</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">Authentication</span>
                    <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Active</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">Total Employees</span>
                    <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">{{ summary.total_employees or 0 }}</span>
                </div>
                <div class="flex justify-between items-center">
                    <span class="text-gray-600">Admin Users</span>
                    <span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">1</span>
                </div>
            </div>
            
            <div class="mt-6 pt-4 border-t border-gray-200">
                <a href="{{ url_for('admin.oversight_reports_view') }}" 
                   class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center">
                    <i class='bx bxs-bar-chart-alt-2 mr-2'></i>
                    View Oversight Reports
                </a>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="card bg-white p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Stats</h3>
            <div class="grid grid-cols-2 gap-4 text-center">
                <div>
                    <div class="text-2xl font-bold text-blue-600">{{ summary.total_roles or 0 }}</div>
                    <div class="text-xs text-gray-500">Roles</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-green-600">{{ summary.total_reporting_lines or 0 }}</div>
                    <div class="text-xs text-gray-500">Reports</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-yellow-600">{{ summary.total_approval_hierarchies or 0 }}</div>
                    <div class="text-xs text-gray-500">Approvals</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-red-600">{{ summary.total_permissions or 0 }}</div>
                    <div class="text-xs text-gray-500">Permissions</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block styles %}
<style>
/* CSS Variables for consistent theming */
:root {
    --primary: #3b82f6;
    --secondary: #6b7280;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --info: #06b6d4;
    --light: #f8fafc;
    --dark: #1f2937;
}

/* Enhanced card styling */
.card {
    border-radius: 12px;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    opacity: 0;
    animation: fadeInUp 0.6s ease-out forwards;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

/* Metric card enhancements */
.metric-card {
    border-left: 4px solid var(--primary);
}

.metric-card.border-l-blue-500 {
    border-left-color: var(--primary);
}
.metric-card.border-l-green-500 {
    border-left-color: var(--success);
}
.metric-card.border-l-yellow-500 {
    border-left-color: var(--warning);
}
.metric-card.border-l-red-500 {
    border-left-color: var(--danger);
}

/* Progress bar styling */
.progress-bar {
    height: 8px;
    border-radius: 4px;
    overflow: hidden;
}

/* Notification dot */
.notification-dot {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: var(--danger);
}

/* Navigation item styling */
.nav-item {
    position: relative;
    transition: all 0.3s ease;
}

.nav-item:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.nav-item.active {
    background-color: rgba(255, 255, 255, 0.15);
}

.nav-item.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 4px;
    background-color: white;
}

/* Hamburger menu */
.hamburger {
    display: none;
}

@media (max-width: 1024px) {
    .hamburger {
        display: block;
    }
}

/* Loading animations */
.card:nth-child(1) { animation-delay: 0.1s; }
.card:nth-child(2) { animation-delay: 0.2s; }
.card:nth-child(3) { animation-delay: 0.3s; }
.card:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Hover effects for action cards */
.hover\:border-blue-300:hover {
    border-color: #93c5fd;
}
.hover\:border-green-300:hover {
    border-color: #86efac;
}
.hover\:border-yellow-300:hover {
    border-color: #fcd34d;
}
.hover\:border-red-300:hover {
    border-color: #fca5a5;
}

/* Button hover effects */
.btn-hover-effect {
    transition: all 0.3s ease;
}

.btn-hover-effect:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Gradient backgrounds */
.gradient-bg {
    background: linear-gradient(135deg, var(--primary) 0%, var(--info) 100%);
}

/* Custom scrollbar */
.custom-scrollbar::-webkit-scrollbar {
    width: 6px;
}

.custom-scrollbar::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 3px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: var(--dark);
}
</style>
{% endblock %}
{% block scripts %}


<script>
document.addEventListener('DOMContentLoaded', function() {
    // Enhanced card animations
    const cards = document.querySelectorAll('.card');
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 150);
    });

    // Add button hover effects
    const buttons = document.querySelectorAll('a[href]');
    buttons.forEach(button => {
        button.classList.add('btn-hover-effect');
    });

    // Smooth scroll for navigation
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Add loading indicators for async actions
    const actionCards = document.querySelectorAll('.card a');
    actionCards.forEach(card => {
        card.addEventListener('click', function() {
            // Add subtle loading effect
            this.style.opacity = '0.7';
            setTimeout(() => {
                this.style.opacity = '1';
            }, 200);
        });
    });
});
</script>
{% endblock %}