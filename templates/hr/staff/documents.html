{% extends "hr/base.html" %}

{% block title %}{{ staff.name }} | Documents{% endblock %}
{% block header %}Staff Documents - {{ staff.name }}{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Staff Header -->
    <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <img class="h-12 w-12 rounded-full" 
                     src="https://ui-avatars.com/api/?name={{ staff.name.replace(' ', '+') }}" 
                     alt="{{ staff.name }}">
                <div>
                    <h2 class="text-xl font-bold text-gray-900">{{ staff.name }}</h2>
                    <p class="text-gray-600">{{ staff.position }} - {{ staff.department }}</p>
                    <p class="text-sm text-gray-500">Staff ID: {{ staff.staff_code or 'Not set' }}</p>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <a href="{{ url_for('hr.staff_details', staff_id=staff.id) }}" 
                   class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                    Back to Profile
                </a>
                <a href="{{ url_for('upload_staff_document', staff_id=staff.id) }}" 
                   class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                    Upload Document
                </a>
            </div>
        </div>
    </div>

    <!-- Documents List -->
    <div class="bg-white rounded-lg shadow">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-800">Employee Documents</h3>
            <p class="text-sm text-gray-600">Manage documents for {{ staff.name }}</p>
        </div>
        
        <div class="p-6">
            {% if documents %}
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {% for doc in documents %}
                    <div class="border rounded-lg p-4 hover:shadow-md transition-shadow">
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0">
                                {% set file_ext = doc.filename.split('.')[-1].lower() %}
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center
                                    {% if file_ext in ['pdf'] %}bg-red-100 text-red-600
                                    {% elif file_ext in ['doc', 'docx'] %}bg-blue-100 text-blue-600
                                    {% elif file_ext in ['jpg', 'jpeg', 'png'] %}bg-green-100 text-green-600
                                    {% else %}bg-gray-100 text-gray-600{% endif %}">
                                    {% if file_ext in ['pdf'] %}<i class='bx bxs-file-pdf text-xl'></i>
                                    {% elif file_ext in ['doc', 'docx'] %}<i class='bx bxs-file-doc text-xl'></i>
                                    {% elif file_ext in ['jpg', 'jpeg', 'png'] %}<i class='bx bxs-image text-xl'></i>
                                    {% else %}<i class='bx bx-file text-xl'></i>{% endif %}
                                </div>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="text-sm font-medium text-gray-900 truncate">{{ doc.name }}</h4>
                                <p class="text-xs text-gray-500 mt-1">{{ doc.folder or 'General' }}</p>
                                {% if doc.tags %}
                                <p class="text-xs text-gray-500 mt-1">{{ doc.tags }}</p>
                                {% endif %}
                                <div class="flex items-center space-x-4 mt-2 text-xs text-gray-500">
                                    <span>{{ (doc.file_size / 1024 / 1024) | round(2) }} MB</span>
                                    <span>{{ doc.uploaded_at.strftime('%B %d, %Y') }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between mt-4 pt-3 border-t border-gray-200">
                            <a href="{{ url_for('download_staff_document', staff_id=staff.id, doc_id=doc.id) }}" 
                               class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                <i class='bx bx-download mr-1'></i>Download
                            </a>
                            <form method="post" action="{{ url_for('delete_staff_document', staff_id=staff.id, doc_id=doc.id) }}" 
                                  class="inline" onsubmit="return confirm('Are you sure you want to delete this document?')">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                                <button type="submit" class="text-red-600 hover:text-red-800 text-sm font-medium">
                                    <i class='bx bx-trash mr-1'></i>Delete
                                </button>
                            </form>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="text-center py-12">
                    <div class="mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4">
                        <i class='bx bx-file text-4xl text-gray-400'></i>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">No documents uploaded</h3>
                    <p class="text-gray-600 mb-6">Start by uploading the first document for {{ staff.name }}</p>
                    <a href="{{ url_for('upload_staff_document', staff_id=staff.id) }}" 
                       class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i class='bx bx-upload mr-2'></i>Upload Document
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}